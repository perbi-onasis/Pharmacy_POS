<!doctype html>
<html lang="en" dir="ltr" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Pharma Invent+</title>

    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- inject:css-->

    <link rel="stylesheet" href="assets/vendor_assets/css/bootstrap/bootstrap.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/daterangepicker.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/fontawesome.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/footable.standalone.min.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/fullcalendar@5.2.0.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/jquery-jvectormap-2.0.5.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/jquery.mCustomScrollbar.min.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/leaflet.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/line-awesome.min.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/magnific-popup.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/MarkerCluster.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/MarkerCluster.Default.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/select2.min.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/slick.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/star-rating-svg.css">

    <link rel="stylesheet" href="assets/vendor_assets/css/trumbowyg.min.css">

    <link rel="stylesheet" href="/assets/vendor_assets/css/wickedpicker.min.css">

    <link rel="stylesheet" href="/style/style.css">

    <!-- endinject -->

    <link rel="icon" type="image/png" sizes="16x16" href="img/favicon.png">

    <!-- Fonts -->
    <link rel="stylesheet" href="https://unicons.iconscout.com/release/v4.0.0/css/line.css">

</head>

<body class="layout-light side-menu">
<div class="mobile-search">
    <form action="/" class="search-form">
        <img src="img/svg/search.svg" alt="search" class="svg">
        <input class="form-control me-sm-2 box-shadow-none" type="search" placeholder="Search..." aria-label="Search">
    </form>
</div>
<div class="mobile-author-actions"></div>
<header class="header-top">
    <nav class="navbar navbar-light">
        <div class="navbar-left">
            <div class="logo-area">
                <a class="navbar-brand" href="dash.html">
                    <img class="dark" src="img/logo-dark.png" alt="logo">
                    <img class="light" src="img/logo-white.png" alt="logo">
                </a>
                <a href="#" class="sidebar-toggle">
                    <img class="svg" src="img/svg/align-center-alt.svg" alt="img"></a>
            </div>
            <!--            <div class="top-menu">-->

            <!--            &lt;!&ndash;               &ndash;&gt;-->

            <!--            </div>-->
        </div>
        <!-- ends: navbar-left -->
        <div class="navbar-right">
            <ul class="navbar-right__menu">
                <li class="nav-search">
                    <a href="#" class="search-toggle">
                        <i class="uil uil-search"></i>
                        <i class="uil uil-times"></i>
                    </a>
                    <form action="/" class="search-form-topMenu">
                        <span class="search-icon uil uil-search"></span>
                        <input class="form-control me-sm-2 box-shadow-none" type="search" placeholder="Search..." aria-label="Search">
                    </form>
                </li>


                <!-- ends: .nav-flag-select -->
                <li class="nav-author">
                    <div class="dropdown-custom">
                        <a href="javascript:;" class="nav-item-toggle"><img src="img/author-nav.jpg" alt="" class="rounded-circle">
                            <span class="nav-item__title">Danial<i class="las la-angle-down nav-item__arrow"></i></span>
                        </a>
                        <div class="dropdown-parent-wrapper">
                            <div class="dropdown-wrapper">
                                <div class="nav-author__info">
                                    <div class="author-img">
                                        <img src="img/author-nav.jpg" alt="" class="rounded-circle">
                                    </div>
                                    <div>
                                        <h6>Rabbi Islam Rony</h6>
                                        <span>UI Designer</span>
                                    </div>
                                </div>
                                <div class="nav-author__options">
                                    <ul>
                                        <li>
                                            <a href="">
                                                <i class="uil uil-setting"></i>
                                                Settings</a>
                                        </li>
                                        <li>
                                            <a href="">
                                                <i class="uil uil-bell"></i> Help</a>
                                        </li>
                                    </ul>
                                    <a href="" class="nav-author__signout">
                                        <i class="uil uil-sign-out-alt"></i> Sign Out</a>
                                </div>
                            </div>
                            <!-- ends: .dropdown-wrapper -->
                        </div>
                    </div>
                </li>
                <!-- ends: .nav-author -->
            </ul>
            <!-- ends: .navbar-right__menu -->
            <div class="navbar-right__mobileAction d-md-none">
                <a href="#" class="btn-search">
                    <img src="img/svg/search.svg" alt="search" class="svg feather-search">
                    <img src="img/svg/x.svg" alt="x" class="svg feather-x"></a>
                <a href="#" class="btn-author-action">
                    <img class="svg" src="img/svg/more-vertical.svg" alt="more-vertical">
                </a>
            </div>
        </div>
        <!-- ends: .navbar-right -->
    </nav>
</header>

<!--  Beginning of Main Content-->
<main class="main-content">

    <div class="sidebar-wrapper">
        <div class="sidebar sidebar-collapse" id="sidebar" >
            <div class="sidebar__menu-group">
                <ul class="sidebar_nav has-child open">
                    <li>
                        <a href="dash.html" class="active">
                            <span class="nav-icon uil uil-create-dashboard"></span>
                            <span class="menu-text">Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="pos.html" class="">
                            <span class="nav-icon uil uil-window-section"></span>
                            <span class="menu-text">Point Of Sale</span>
                        </a>
                    </li>
                    <li>
                        <a href="stocks.html" class="">
                            <span class="nav-icon uil uil-arrow-growth"></span>
                            <span class="menu-text">Stock Management</span>
                        </a>
                    </li>
                    <li>
                        <a href="reports.html" class="">
                            <span class="nav-icon uil uil-arrow-growth"></span>
                            <span class="menu-text">Financial Reports</span>
                        </a>
                    </li>
                    <li class="">
                        <a href="settings.html">
                            <span class="nav-icon uil "></span>
                            <span class="menu-text">Settings</span>
                        </a>
                    </li>
                    <li class="">
                        <a href="#">
                            <span class="nav-icon uil uil-sign-out-alt"></span>
                            <span class="menu-text">Sign Out</span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!------Main Content------>
    <div class="contents">

        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12">

                    <div class="breadcrumb-main">
                        <h4 class="text-capitalize breadcrumb-title">Products</h4>
                        <div class="breadcrumb-action justify-content-center flex-wrap">
                            <nav aria-label="breadcrumb">
                                <ol class="breadcrumb">
                                    <li class="breadcrumb-item"><a href="#"><i class="uil uil-estate"></i>Products</a></li>
                                </ol>
                            </nav>
                        </div>
                    </div>

                </div>
            </div>
            <div class="row">
                <!---  Products Table  -->
                <div class="col-8 mb-30">
                    <div class="support-ticket-system support-ticket-system--search">

                        <div class="breadcrumb-main m-0 breadcrumb-main--table justify-content-sm-between ">
                            <div class=" d-flex flex-wrap justify-content-center breadcrumb-main__wrapper">
                                <div class="d-flex align-items-center ticket__title justify-content-center me-md-25 mb-md-0 mb-20">
                                    <h4 class="text-capitalize fw-500 breadcrumb-title">Products Table</h4>
                                </div>
                            </div>
                            <div class="action-btn">
                                <a href="#" class="btn btn-primary">
                                    Export
                                    <i class="las la-angle-down"></i>
                                </a>
                            </div>
                        </div>

                        <div class="support-form datatable-support-form d-flex justify-content-xxl-between justify-content-center align-items-center flex-wrap">
                            <div class="support-form__search">
                                <div class="support-order-search">
                                    <form action="/" class="support-order-search__form">
                                        <img src="img/svg/search.svg" alt="search" class="svg">
                                        <input id="searchInput" class="form-control border-0 box-shadow-none" type="search" placeholder="Search" aria-label="Search">
                                    </form>
                                </div>
                            </div>
                        </div>
                        <div class="userDatatable userDatatable--ticket userDatatable--ticket--2 mt-1">
                            <div class="table-responsive">
                                <table class="table mb-0 table-borderless">
                                    <thead>
                                    <tr class="userDatatable-header">
                                        <th>
                                            <span class="userDatatable-title">ID</span>
                                        </th>
                                        <th>
                                            <span class="userDatatable-title">Product Name</span>
                                        </th>
                                        <th>
                                            <span class="userDatatable-title">Quantity</span>
                                        </th>
                                        <th>
                                            <span class="userDatatable-title">Price - Ghs</span>
                                        </th>
                                        <th>
                                            <span class="userDatatable-title">Category</span>
                                        </th>
                                        <th>
                                            <span class="userDatatable-title">Action</span>
                                        </th>
                                    </tr>
                                    </thead>
                                    <tbody id="posProductTableBody">

                                        <!--<tr th:each="product : ${products}" onclick="addToCart('click', '${product.name}', ${product.price})">
                                        <td>#01</td>
                                        <td>
                                            <div class="d-flex">
                                                <div class="userDatatable-inline-title">
                                                    <a href="#" class="text-dark fw-500">
                                                        <h6 th:text="${product.name}">Product name</h6>
                                                    </a>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="userDatatable-content&#45;&#45;subject" th:text="${product.quantity}">
                                                243
                                            </div>
                                        </td>
                                        <td>
                                            <div class="userDatatable-content&#45;&#45;subject" th:text="${product.price}">
                                          3.00
                                       </div>
                                    </td>
                                    <td>
                                       <div class="userDatatable-content&#45;&#45;priority">
                                            Pain Killer
                            </div>
                            </td>
                            <td>
                                <a href="#" class="edit">
                                    Add
                                </a>
                            </td>
                            </tr>
-->
                                   </tbody>
                                </table>
                        </div>
                        <div class="d-flex justify-content-end pt-30">

                            <nav class="dm-page ">
                                <ul class="dm-pagination d-flex">
                                    <li class="dm-pagination__item">
                                        <a href="#" class="dm-pagination__link pagination-control"><span class="la la-angle-left"></span></a>
                                        <a href="#" class="dm-pagination__link"><span class="page-number">1</span></a>
                                        <a href="#" class="dm-pagination__link active"><span class="page-number">2</span></a>
                                        <a href="#" class="dm-pagination__link"><span class="page-number">3</span></a>
                                        <a href="#" class="dm-pagination__link pagination-control"><span class="page-number">...</span></a>
                                        <a href="#" class="dm-pagination__link"><span class="page-number">12</span></a>
                                        <a href="#" class="dm-pagination__link pagination-control"><span class="la la-angle-right"></span></a>
                                        <a href="#" class="dm-pagination__option">
                                        </a>
                                    </li>
                                    <li class="dm-pagination__item">
                                        <div class="paging-option">
                                            <select name="page-number" class="page-selection">
                                                <option value="20">20/page</option>
                                                <option value="40">40/page</option>
                                                <option value="60">60/page</option>
                                            </select>
                                        </div>
                                    </li>
                                </ul>
                            </nav>

                        </div>
                    </div>
                </div>
            </div>

            <!---- Order Cart -->
            <div class="col-4 mb-30">
                <div class="card card-default card-md bg- ">
                    <div class="card-header">
                        <h6>Cart</h6>
                        <button class="primary-button">Clear</button>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table id="cart" class="table table-borderless table-hover">
                                <tbody id="cart-item">


                                <!--<tr>

                                    <td>
                                        <div class="medi a align-items-center">
                                            <div class="media-body">
                                                <h5 class="mt-0">Fiber base chair</h5>
                                                <div class="price">$248.66</div>
                                            </div>

                                        </div>
                                    </td>

                                    <td>
                                        <div>
                                            &lt;!&ndash; Start: Product Quantity &ndash;&gt;
                                            <div class="quantity product-cart__quantity justify-content-between">

                                                <input type="button" value="-" class="qty-minus bttn bttn-left wh-36">
                                                <input type="number" value="1" class="qty qh-36 input overflow-hidden">
                                                <input type="button" value="+" class="qty-plus bttn bttn-right wh-36">

                                                <button type="button" class="action-btn float-end ml">
                                                    <i class="las la-trash-alt"></i>
                                                </button>
                                            </div>
                                            &lt;!&ndash; End: Product Quantity &ndash;&gt;

                                        </div>
                                    </td>

                                </tr>-->


                                </tbody>
                                <tfoot>

                                </tfoot>
                            </table><!-- End: table -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <!------ End of Main Content ---->

    <footer class="footer-wrapper">
        <div class="footer-wrapper__inside">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-md-6">
                        <div class="footer-copyright">
                            <p><span>© 2023</span><a href="#">Sovware</a>
                            </p>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="footer-menu text-end">
                            <ul>
                                <li>
                                    <a href="#">About</a>
                                </li>
                                <li>
                                    <a href="#">Team</a>
                                </li>
                                <li>
                                    <a href="#">Contact</a>
                                </li>
                            </ul>
                        </div>
                        <!-- ends: .Footer Menu -->
                    </div>
                </div>
            </div>
        </div>
    </footer>
    </div>
</main>
<!--  End of Main Content  -->
<div id="overlayer">
    <div class="loader-overlay">
        <div class="dm-spin-dots spin-lg">
            <span class="spin-dot badge-dot dot-primary"></span>
            <span class="spin-dot badge-dot dot-primary"></span>
            <span class="spin-dot badge-dot dot-primary"></span>
            <span class="spin-dot badge-dot dot-primary"></span>
        </div>
    </div>
</div>
<div class="overlay-dark-sidebar"></div>
<div class="customizer-overlay"></div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<!--Start In-Page Modals-->

<!--End In-Page Modals-->


<!--Start In-Page Scripts-->
<script>
    $(document).ready(function() {
        // Initialize counter
        var counter = 1;

        // Fetch products from the server and populate the product table
        fetchProducts(counter);
    });

    function fetchProducts(counter) {
        $.get("/products")
            .done(function(products) {
                // Clear existing table rows
                $("#posProductTableBody").empty();

                // Iterate over products and add rows to the table
                products.forEach(function(product) {
                    var row = `
                        <tr>
                            <td>${counter++}</td>
                            <td>${product.name}</td>
                            <td>${product.quantityInStock}</td>
                            <td>${product.sellingPrice}</td>
                            <td>${product.categoryId}</td>
                            <td>
                                <a href="#" class="edit" onclick="addToCart('${product.id}', '${product.name}', ${product.sellingPrice})">Add</a>
                            </td>
                            <!-- Hidden cell for product ID -->
                            <td style="display: none;">${product.id}</td>
                        </tr>`;
                    $("#posProductTableBody").append(row);
                });
            })
            .fail(function(xhr, status, error) {
                console.error("Failed to fetch products:", error);
            });
    }

    // Script to add to Cart, Delete Item and Clear Cart
        // Array to store cart items
    let cartItems = [];

    // Event listener for Add button in product table
    $(document).on('click', '.edit', function() {
        let $row = $(this).closest('tr');
        let productId = $row.find('td:last-child').text();
        let productName = $row.find('td:eq(1)').text();
        let price = parseFloat($row.find('td:eq(3)').text());
        let quantity = parseInt($row.find('td:eq(2)').text());

        // Check if item already exists in cart
        let existingItem = cartItems.find(item => item.productId === productId);
        if (existingItem) {
            // Increment quantity if item already exists
            existingItem.quantity++;
            updateCartItem(existingItem);
        } else {
            // Add new item to cart
            let newItem = {
                productId: productId,
                productName: productName,
                price: price,
                quantity: 1
            };
            cartItems.push(newItem);
            addCartItem(newItem);
        }
    });

    // Function to add cart item to the table
    function addCartItem(item) {
        let $cartBody = $('#cart-item');
        let total = item.price * item.quantity;
        let row = `
            <tr data-id="${item.productId}">
                <td>${item.productName}</td>
                <td>${item.price.toFixed(2)}</td>
                <td>
                    <button class="qty-minus" data-id="${item.productId}">-</button>
                    <input type="number" value="${item.quantity}" min="1" class="qty">
                    <button class="qty-plus" data-id="${item.productId}">+</button>
                </td>
                <td class="total">${total.toFixed(2)}</td>
                <td><button class="delete" data-id="${item.productId}">Delete</button></td>
            </tr>`;
        $cartBody.append(row);
        updateTotal();
    }

    // Event listener for Clear button
    $('#clearCartBtn').click(function() {
        $('#cart-item').empty();
        cartItems = [];
        updateTotal();
    });

    // Event listener for Delete button
    $(document).on('click', '.delete', function() {
        let productId = $(this).data('id');
        $(`#cart-item tr[data-id="${productId}"]`).remove();
        cartItems = cartItems.filter(item => item.productId !== productId);
        updateTotal();
    });

    // Event listener for Quantity +/- buttons
    $(document).on('click', '.qty-minus, .qty-plus', function() {
        let productId = $(this).data('id');
        let $qtyInput = $(this).siblings('.qty');
        let quantity = parseInt($qtyInput.val());
        if ($(this).hasClass('qty-minus')) {
            quantity = Math.max(quantity - 1, 1);
        } else {
            quantity++;
        }
        $qtyInput.val(quantity);
        let item = cartItems.find(item => item.productId === productId);
        if (item) {
            item.quantity = quantity;
            updateCartItem(item);
        }
    });

    // Function to update cart item in the table
    function updateCartItem(item) {
        let $row = $(`#cart-item tr[data-id="${item.productId}"]`);
        let total = item.price * item.quantity;
        $row.find('.qty').val(item.quantity);
        $row.find('.total').text(total.toFixed(2));
        updateTotal();
    }

    // Function to update total price in the table
    function updateTotal() {
        let total = 0;
        cartItems.forEach(item => {
            total += item.price * item.quantity;
        });
        $('#cart tfoot').html(`<tr><td colspan="4">Total: Ghs ${total.toFixed(2)}</td></tr>`);
    }


    // Search Function to Filter Product(s) on the Products Table
    // Function to filter products based on search keyword
function filterProducts() {
    var input, filter, table, tr, td, i, txtValue;
    input = document.getElementById("searchInput");
    filter = input.value.toUpperCase();
    table = document.getElementById("posProductTableBody");
    tr = table.getElementsByTagName("tr");

    for (i = 0; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[1]; // Change index if product name is in different column
        if (td) {
            txtValue = td.textContent || td.innerText;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                tr[i].style.display = "";
            } else {
                tr[i].style.display = "none";
            }
        }
    }
}

// Add event listener to the search input field
document.getElementById("searchInput").addEventListener("keyup", filterProducts);

</script>
<!--End In-Page Scripts-->



<!--Functionality Script Injection-->






<script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyBgYKHZB_QKKLWfIRaYPCadza3nhTAbv7c"></script>
<!-- inject:js-->
<script src="assets/vendor_assets/js/jquery/jquery-3.5.1.min.js"></script>
<script src="assets/vendor_assets/js/jquery/jquery-ui.js"></script>
<script src="assets/vendor_assets/js/bootstrap/popper.js"></script>
<script src="assets/vendor_assets/js/bootstrap/bootstrap.min.js"></script>
<script src="assets/vendor_assets/js/moment/moment.min.js"></script>
<script src="assets/vendor_assets/js/accordion.js"></script>
<script src="assets/vendor_assets/js/apexcharts.min.js"></script>
<script src="assets/vendor_assets/js/autoComplete.js"></script>
<script src="assets/vendor_assets/js/Chart.min.js"></script>
<script src="assets/vendor_assets/js/daterangepicker.js"></script>
<script src="assets/vendor_assets/js/drawer.js"></script>
<script src="assets/vendor_assets/js/dynamicBadge.js"></script>
<script src="assets/vendor_assets/js/dynamicCheckbox.js"></script>
<script src="assets/vendor_assets/js/footable.min.js"></script>
<script src="assets/vendor_assets/js/fullcalendar@5.2.0.js"></script>
<script src="assets/vendor_assets/js/google-chart.js"></script>
<script src="assets/vendor_assets/js/jquery-jvectormap-2.0.5.min.js"></script>
<script src="assets/vendor_assets/js/jquery-jvectormap-world-mill-en.js"></script>
<script src="assets/vendor_assets/js/jquery.countdown.min.js"></script>
<script src="assets/vendor_assets/js/jquery.filterizr.min.js"></script>
<script src="assets/vendor_assets/js/jquery.magnific-popup.min.js"></script>
<script src="assets/vendor_assets/js/jquery.peity.min.js"></script>
<script src="assets/vendor_assets/js/jquery.star-rating-svg.min.js"></script>
<script src="assets/vendor_assets/js/leaflet.js"></script>
<script src="assets/vendor_assets/js/leaflet.markercluster.js"></script>
<script src="assets/vendor_assets/js/loader.js"></script>
<script src="assets/vendor_assets/js/message.js"></script>
<script src="assets/vendor_assets/js/moment.js"></script>
<script src="assets/vendor_assets/js/muuri.min.js"></script>
<script src="assets/vendor_assets/js/notification.js"></script>
<script src="assets/vendor_assets/js/popover.js"></script>
<script src="assets/vendor_assets/js/select2.full.min.js"></script>
<script src="assets/vendor_assets/js/slick.min.js"></script>
<script src="assets/vendor_assets/js/trumbowyg.min.js"></script>
<script src="assets/vendor_assets/js/wickedpicker.min.js"></script>
<script src="assets/theme_assets/js/apexmain.js"></script>
<script src="assets/theme_assets/js/charts.js"></script>
<script src="assets/theme_assets/js/drag-drop.js"></script>
<script src="assets/theme_assets/js/footable.js"></script>
<script src="assets/theme_assets/js/full-calendar.js"></script>
<script src="assets/theme_assets/js/googlemap-init.js"></script>
<script src="assets/theme_assets/js/icon-loader.js"></script>
<script src="assets/theme_assets/js/jvectormap-init.js"></script>
<script src="assets/theme_assets/js/leaflet-init.js"></script>
<script src="assets/theme_assets/js/main.js"></script>
<!-- endinject-->
</body>

</html>